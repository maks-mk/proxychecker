# üõ°Ô∏è Sing-box Proxy Checker Bot (v5.1 Fixed)

–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–æ–≤.
–ü–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –±–∞–∑–µ —è–¥—Ä–∞ **Sing-box** —Å "Enterprise" –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π. –í–µ—Ä—Å–∏—è v5.1 –≤–∫–ª—é—á–∞–µ—Ç –≥–ª—É–±–æ–∫—É—é –æ—á–∏—Å—Ç–∫—É —Å—Å—ã–ª–æ–∫, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –¥—É–±–ª–µ–π –∏ –∑–∞—â–∏—Ç—É –æ—Ç –∫–æ–ª–ª–∏–∑–∏–π –ø–æ—Ä—Ç–æ–≤.

![Python](https://img.shields.io/badge/Python-3.9%2B-blue) ![Aiogram](https://img.shields.io/badge/Aiogram-3.x-blue) ![Sing-box](https://img.shields.io/badge/Core-Sing--box_1.9.0-success)

---

## ‚ö° –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ v5.1?

1.  **Smart Link Cleaning (NekoBox Fix):**
    *   –ë–æ—Ç —Ç–µ–ø–µ—Ä—å **–ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç** –º—É—Å–æ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`&name=...`, `&spider=...`, `&remarks=...`) –∏–∑ —Å—Å—ã–ª–æ–∫ **–¥–æ** –ø—Ä–æ–≤–µ—Ä–∫–∏.
    *   **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í –∫–ª–∏–µ–Ω—Ç–∞—Ö (NekoBox, v2rayNG) –±–æ–ª—å—à–µ –Ω–µ—Ç "–∏–µ—Ä–æ–≥–ª–∏—Ñ–æ–≤" –∏ –¥–ª–∏–Ω–Ω—ã—Ö –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π. –°—Å—ã–ª–∫–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –∫—Ä–∏—Å—Ç–∞–ª—å–Ω–æ —á–∏—Å—Ç—ã–º–∏.
2.  **True Deduplication:**
    *   –ë–ª–∞–≥–æ–¥–∞—Ä—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–µ, –±–æ—Ç —Ç–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥–∏—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã —Å–æ 100% —Ç–æ—á–Ω–æ—Å—Ç—å—é. –°—Å—ã–ª–∫–∞ `vless://uuid@ip:443#Name1` –∏ `vless://uuid@ip:443?name=garbage#Name2` —Ç–µ–ø–µ—Ä—å —Å—á–∏—Ç–∞—é—Ç—Å—è –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ.
3.  **Port Manager:**
    *   –í–Ω–µ–¥—Ä–µ–Ω –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ—Ä—Ç–æ–≤ —Å —Ä–æ—Ç–∞—Ü–∏–µ–π (–¥–∏–∞–ø–∞–∑–æ–Ω 20000‚Äì55000). –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ `Address already in use` –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ.

---

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
*   **Global ThreadPool:** –ï–¥–∏–Ω—ã–π –ø—É–ª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 200 –ø–æ—Ç–æ–∫–æ–≤) –¥–ª—è –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑ –ø–æ–¥–≤–∏—Å–∞–Ω–∏–π –±–æ—Ç–∞.
*   **TCP Pre-Check:** –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç—Å–µ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤ (—á–µ—Ä–µ–∑ Python socket) –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Ç—è–∂–µ–ª–æ–≥–æ —è–¥—Ä–∞ Sing-box. –≠–∫–æ–Ω–æ–º–∏—Ç –¥–æ 70% –≤—Ä–µ–º–µ–Ω–∏.
*   **Fail-Fast Core:** –ê–≤—Ç–æ-–∑–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Windows, Linux –∏ macOS.
*   **IP Leak Check:** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ IP –ø—Ä–æ–∫—Å–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º IP —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç "–ø—Ä–æ–∑—Ä–∞—á–Ω—ã—Ö" –ø—Ä–æ–∫—Å–∏.

### üìä –û—Ç—á–µ—Ç—ã –∏ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ë–æ—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —á–∏—Å—Ç—ã–π —Ñ–∞–π–ª `live_HH-MM.txt` —Å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ –ø–∏–Ω–≥—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.

**–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:**
```text
vless://uuid@ip:port?security=reality&sni=google.com&fp=chrome&type=tcp#üá©üá™ DE | üöÄ 125ms | VLESS
```
*–ù–∏–∫–∞–∫–æ–≥–æ –ª–∏—à–Ω–µ–≥–æ –º—É—Å–æ—Ä–∞ –≤ URL, —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.*

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1.  **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Python 3.8+
2.  **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install aiogram requests aiohttp
    ```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥ (`bot.py`)
–í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à —Ç–æ–∫–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–∏–º–∏—Ç—ã:

```python
TOKEN = "123456789:ABC..."

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–∏–º–∏—Ç–æ–≤ (Anti-Abuse)
MAX_FILES_PER_USER = 5      # –ú–∞–∫—Å. —Ñ–∞–π–ª–æ–≤ –≤ –æ—á–µ—Ä–µ–¥–∏
MAX_LINKS_PER_CHECK = 1000  # –õ–∏–º–∏—Ç —Å—Å—ã–ª–æ–∫ –∑–∞ –æ–¥–Ω—É –ø—Ä–æ–≤–µ—Ä–∫—É
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –î–≤–∏–∂–∫–∞ (`checker_engine.py`)
–î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```python
TIMEOUT_SEC = 6             # –¢–∞–π–º–∞—É—Ç –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (—Å–µ–∫)
CHECK_IP_LEAK = True        # –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏, –µ—Å–ª–∏ IP –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
GLOBAL_POOL = ThreadPoolExecutor(max_workers=200) # –ö–æ–ª-–≤–æ –ø–æ—Ç–æ–∫–æ–≤ (—É–º–µ–Ω—å—à–∏—Ç–µ –¥–æ 100 –¥–ª—è —Å–ª–∞–±—ã—Ö VPS)
```

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

```bash
python bot.py
```
*–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ —è–¥—Ä–æ Sing-box (v1.9.0).*

---

## ü§ñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1.  **–ó–∞–≥—Ä—É–∑–∫–∞:**
    –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É **.txt —Ñ–∞–π–ª** (–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ).
    *   –ë–æ—Ç: "–ü—Ä–∏–Ω—è—Ç–æ +500 —Å—Å—ã–ª–æ–∫. –û—Ç—Å–µ—è–Ω–æ 20 –¥—É–±–ª–µ–π (–≤–∫–ª—é—á–∞—è —Å–∫—Ä—ã—Ç—ã–µ –¥—É–±–ª–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏)."
2.  **–ü—Ä–æ–≤–µ—Ä–∫–∞:**
    –ù–∞–∂–º–∏—Ç–µ **üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É**.
    *   –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
3.  **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
    –ü–æ–ª—É—á–∏—Ç–µ —Ñ–∞–π–ª `live_....txt` —Å —Ä–∞–±–æ—á–∏–º–∏ –ø—Ä–æ–∫—Å–∏.
4.  **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
    *   `/clear` ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å —Ñ–∞–π–ª–æ–≤.
    *   –ö–Ω–æ–ø–∫–∞ **‚õî –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å** ‚Äî —ç–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ —É—Å–ø–µ–ª–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å—Å—è.

---

## üìú –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
*   **VLESS** (Reality, Vision, gRPC, WS, TCP)
*   **VMess** (WS, gRPC, TCP)
*   **Trojan**
*   **Shadowsocks** (–≤–∫–ª—é—á–∞—è —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç –∏ SIP002)
*   **Hysteria 2**

---
*License: MIT*